{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useState } from \"react\";\nimport { createContext } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { useDispatch } from \"react-redux\";\nimport * as authAction from \"../../store/redux/actions/auth.actions\";\nimport * as userAction from \"../../store/redux/actions/user.actions\";\nimport { createNextState } from \"@reduxjs/toolkit\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      userToken = _useState4[0],\n      setUserToken = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      uid = _useState6[0],\n      setUid = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      userFoodTrue = _useState8[0],\n      setUserFoodTrue = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      userInfo = _useState10[0],\n      setUserInfo = _useState10[1];\n\n  var dispatch = useDispatch();\n\n  var login = function login(_ref2) {\n    var email = _ref2.email,\n        password = _ref2.password;\n    setIsLoading(true);\n    dispatch(authAction.loginUser({\n      email: email,\n      password: password\n    })).then(function (resultData) {\n      if (resultData.success) {\n        try {\n          setUserToken(resultData.token);\n          setUid(resultData.id);\n          console.log(resultData.id);\n          AsyncStorage.setItem(\"userToken\", resultData.token);\n          AsyncStorage.setItem(\"uid\", resultData.id);\n          console.log(resultData.usersfood);\n\n          if (resultData.usersfood > 0) {\n            setUserFoodTrue(true);\n          }\n\n          setIsLoading(false);\n        } catch (err) {\n          console.log(err);\n        }\n      } else {\n        setIsLoading(false);\n        Alert.alert(\"Authentication failed\", \"Could not log you in :( Please check your credentials or try again later.\");\n      }\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n\n  var logout = function logout() {\n    setIsLoading(true);\n    setUserToken(null);\n    AsyncStorage.removeItem(\"userToken\");\n    setIsLoading(false);\n    console.log(\"logged out\");\n  };\n\n  var isLoggedIn = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      try {\n        setIsLoading(true);\n\n        var _userToken = yield AsyncStorage.getItem(\"userToken\");\n\n        var userId = yield AsyncStorage.getItem(\"uid\");\n        var userfood = yield AsyncStorage.getItem(\"userfood\");\n        setUserToken(_userToken);\n        setUid(userId);\n        console.log(_userToken);\n        setIsLoading(false);\n      } catch (e) {\n        console.log(\"Islogged in error \" + e);\n      }\n    });\n\n    return function isLoggedIn() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var register = function register(_ref4) {\n    var email = _ref4.email,\n        password = _ref4.password;\n    setIsLoading(true);\n    dispatch(authAction.registerUser({\n      email: email,\n      password: password\n    })).then(function (resultData) {\n      if (resultData.success) {\n        try {\n          setUserToken(resultData.token);\n          setUid(resultData.id);\n          AsyncStorage.setItem(\"userToken\", resultData.token);\n          console.log(resultData.usersfood);\n          setIsLoading(false);\n        } catch (err) {\n          console.log(err);\n        }\n      } else {\n        setIsLoading(false);\n        Alert.alert(\"Sign up failed.\", \"Could not create user, please check your input or try again later\");\n      }\n    }).catch(function (err) {\n      return console.log(err);\n    });\n  };\n\n  var addFood = function addFood() {\n    setUserFood(true);\n  };\n\n  useEffect(function () {\n    isLoggedIn();\n  }, []);\n  return _jsx(AuthContext.Provider, {\n    value: {\n      login: login,\n      logout: logout,\n      register: register,\n      addFood: addFood,\n      userFoodTrue: userFoodTrue,\n      uid: uid,\n      isLoading: isLoading,\n      userToken: userToken\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["useState","createContext","AsyncStorage","useEffect","axios","useDispatch","authAction","userAction","createNextState","AuthContext","AuthProvider","children","isLoading","setIsLoading","userToken","setUserToken","uid","setUid","userFoodTrue","setUserFoodTrue","userInfo","setUserInfo","dispatch","login","email","password","loginUser","then","resultData","success","token","id","console","log","setItem","usersfood","err","Alert","alert","catch","logout","removeItem","isLoggedIn","getItem","userId","userfood","e","register","registerUser","addFood","setUserFood"],"sources":["/Users/elodiepradet/Documents/react native/Fridgeease/src/components/AppContext.js"],"sourcesContent":["//Creating the uid context, user id context, that will get the user token\nimport { useState } from \"react\";\nimport { createContext } from \"react\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Alert } from \"react-native\";\nimport { useDispatch } from \"react-redux\";\nimport * as authAction from \"../../store/redux/actions/auth.actions\";\nimport * as userAction from \"../../store/redux/actions/user.actions\";\n\nimport { createNextState } from \"@reduxjs/toolkit\";\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [isLoading, setIsLoading] = useState(false);\n  const [userToken, setUserToken] = useState(null);\n  const [uid, setUid] = useState(null);\n  const [userFoodTrue, setUserFoodTrue] = useState(false);\n  const [userInfo, setUserInfo] = useState(null);\n  const dispatch = useDispatch();\n\n  const login = ({ email, password }) => {\n    setIsLoading(true);\n    dispatch(authAction.loginUser({ email, password }))\n      .then((resultData) => {\n        if (resultData.success) {\n          try {\n            setUserToken(resultData.token);\n            setUid(resultData.id);\n\n            console.log(resultData.id);\n            AsyncStorage.setItem(\"userToken\", resultData.token);\n            AsyncStorage.setItem(\"uid\", resultData.id);\n\n            console.log(resultData.usersfood);\n            if (resultData.usersfood > 0) {\n              setUserFoodTrue(true);\n            }\n            setIsLoading(false);\n          } catch (err) {\n            console.log(err);\n          }\n        } else {\n          setIsLoading(false);\n          Alert.alert(\n            \"Authentication failed\",\n            \"Could not log you in :( Please check your credentials or try again later.\"\n          );\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n\n  const logout = () => {\n    setIsLoading(true);\n    setUserToken(null);\n    AsyncStorage.removeItem(\"userToken\");\n    setIsLoading(false);\n    console.log(\"logged out\");\n  };\n\n  const isLoggedIn = async () => {\n    try {\n      setIsLoading(true);\n      let userToken = await AsyncStorage.getItem(\"userToken\");\n      let userId = await AsyncStorage.getItem(\"uid\");\n      let userfood = await AsyncStorage.getItem(\"userfood\");\n      setUserToken(userToken);\n      setUid(userId);\n      console.log(userToken);\n      setIsLoading(false);\n    } catch (e) {\n      console.log(`Islogged in error ${e}`);\n    }\n  };\n\n  const register = ({ email, password }) => {\n    setIsLoading(true);\n    dispatch(authAction.registerUser({ email, password }))\n      .then((resultData) => {\n        if (resultData.success) {\n          try {\n            setUserToken(resultData.token);\n            setUid(resultData.id);\n\n            AsyncStorage.setItem(\"userToken\", resultData.token);\n            console.log(resultData.usersfood);\n            setIsLoading(false);\n          } catch (err) {\n            console.log(err);\n          }\n        } else {\n          setIsLoading(false);\n\n          Alert.alert(\n            \"Sign up failed.\",\n            \"Could not create user, please check your input or try again later\"\n          );\n        }\n      })\n      .catch((err) => console.log(err));\n  };\n\n  const addFood = () => {\n    setUserFood(true);\n  };\n\n  useEffect(() => {\n    isLoggedIn();\n  }, []);\n  return (\n    <AuthContext.Provider\n      value={{\n        login,\n        logout,\n        register,\n        addFood,\n        userFoodTrue,\n        uid,\n        isLoading,\n        userToken,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}